setGPU: Setting GPU to: 4
reading /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts
reading  /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts
num files in dir: 26
168377 events passed mass cut at 1100.0
168376 events passed mass cut at 1100.0
168376 events passed mass cut at 1100.0
168376 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211319 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211319 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211320 events passed mass cut at 1100.0
211319 events passed mass cut at 1100.0

num files read in dir  /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts :  26

num events read in dir  5322542
reading /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts
reading  /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts
num files in dir: 2
256253 events passed mass cut at 1100.0
256252 events passed mass cut at 1100.0

num files read in dir  /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts :  2

num events read in dir  512505
reading /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts
reading  /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts
num files in dir: 2
257745 events passed mass cut at 1100.0
257744 events passed mass cut at 1100.0

num files read in dir  /eos/home-k/kiwoznia/dev/autoencoder_for_anomaly/convolutional_VAE/results/run_101/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts :  2

num events read in dir  515489
['mJJ', 'j1Pt', 'j1Eta', 'j1Phi', 'j1M', 'j1E', 'j2Pt', 'j2M', 'j2E', 'DeltaEtaJJ', 'DeltaPhiJJ', 'j1TotalLoss', 'j2TotalLoss', 'j2RecoLoss', 'j2KlLoss', 'j1RecoLoss', 'j1KlLoss']
writing analysis results to  /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10
WARNING: Logging before flag parsing goes to stderr.
W0911 18:12:11.449149 139847022724928 deprecation.py:506] From /cvmfs/sft.cern.ch/lcg/views/LCG_96bpython3/x86_64-centos7-gcc9-opt/lib/python3.6/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0911 18:12:11.632741 139847022724928 deprecation.py:323] From /eos/home-k/kiwoznia/dev/data_driven_anomaly_hunting/dadrah/selection/quantile_regression.py:14: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1)]               0         
_________________________________________________________________
dense (Dense)                (None, 70)                140       
_________________________________________________________________
dense_1 (Dense)              (None, 70)                4970      
_________________________________________________________________
dense_2 (Dense)              (None, 70)                4970      
_________________________________________________________________
dense_3 (Dense)              (None, 70)                4970      
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 71        
=================================================================
Total params: 15,121
Trainable params: 15,121
Non-trainable params: 0
_________________________________________________________________
Train on 1277409 samples, validate on 319353 samples
Epoch 1/100
2020-09-11 18:12:12.169990: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-09-11 18:12:12.193174: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200025000 Hz
2020-09-11 18:12:12.200789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1f0879e0 executing computations on platform Host. Devices:
2020-09-11 18:12:12.200848: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-09-11 18:12:12.283488: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
1277409/1277409 - 30s - loss: 0.0235 - val_loss: 0.0235
Epoch 2/100
1277409/1277409 - 30s - loss: 0.0233 - val_loss: 0.0232
Epoch 3/100
1277409/1277409 - 29s - loss: 0.0233 - val_loss: 0.0232
Epoch 4/100
1277409/1277409 - 29s - loss: 0.0232 - val_loss: 0.0231
Epoch 5/100
1277409/1277409 - 29s - loss: 0.0232 - val_loss: 0.0231
Epoch 6/100
1277409/1277409 - 29s - loss: 0.0232 - val_loss: 0.0232
Epoch 7/100
1277409/1277409 - 29s - loss: 0.0232 - val_loss: 0.0232
Epoch 8/100

Epoch 00008: ReduceLROnPlateau reducing learning rate to 0.00020000000949949026.
1277409/1277409 - 30s - loss: 0.0232 - val_loss: 0.0232
Epoch 9/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 10/100
1277409/1277409 - 30s - loss: 0.0231 - val_loss: 0.0231
Epoch 11/100

Epoch 00011: ReduceLROnPlateau reducing learning rate to 4.0000001899898055e-05.
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 12/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 13/100
1277409/1277409 - 30s - loss: 0.0231 - val_loss: 0.0231
Epoch 14/100

Epoch 00014: ReduceLROnPlateau reducing learning rate to 8.000000525498762e-06.
1277409/1277409 - 30s - loss: 0.0231 - val_loss: 0.0231
Epoch 15/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 16/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 17/100

Epoch 00017: ReduceLROnPlateau reducing learning rate to 1.6000001778593287e-06.
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 18/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 19/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 20/100

Epoch 00020: ReduceLROnPlateau reducing learning rate to 3.200000264769187e-07.
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 21/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 22/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 23/100

Epoch 00023: ReduceLROnPlateau reducing learning rate to 6.400000529538374e-08.
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 24/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 25/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 26/100

Epoch 00026: ReduceLROnPlateau reducing learning rate to 1.2800001059076749e-08.
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 27/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 28/100
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 29/100

Epoch 00029: ReduceLROnPlateau reducing learning rate to 2.5600002118153498e-09.
1277409/1277409 - 29s - loss: 0.0231 - val_loss: 0.0231
Epoch 00029: early stopping
saving model  QRmodel_train_sz30pc_qnt10_20200911
min 1100.0001220703125, max 6713.01171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/fig/QCD_training_set:_BG_like_vs_SIG_like_mjj_distribution_and_their_ratio_qnt_10.jpg has been created
min 1100.0001220703125, max 7338.603515625
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/fig/QCD_test_set:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_10.jpg has been created
+---------------+-------------+
|     Sample    | Eff VAE [%] |
+---------------+-------------+
| qcdSigAllReco |     9.98    |
| GtoWW25naReco |    20.10    |
| GtoWW35naReco |    22.11    |
+---------------+-------------+
min 1100.037841796875, max 6329.51171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/fig/GtoWW25naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_10.jpg has been created
min 1100.159423828125, max 6971.1318359375
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/fig/GtoWW35naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_10.jpg has been created
writing results for QCD signalregion all samples reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/10/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/10/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
writing results for $G(2.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/10/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/10/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
writing results for $G(3.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/10/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/10/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
writing analysis results to  /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30
Model: "model_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, 1)]               0         
_________________________________________________________________
dense_5 (Dense)              (None, 70)                140       
_________________________________________________________________
dense_6 (Dense)              (None, 70)                4970      
_________________________________________________________________
dense_7 (Dense)              (None, 70)                4970      
_________________________________________________________________
dense_8 (Dense)              (None, 70)                4970      
_________________________________________________________________
dense_9 (Dense)              (None, 1)                 71        
=================================================================
Total params: 15,121
Trainable params: 15,121
Non-trainable params: 0
_________________________________________________________________
Train on 1277409 samples, validate on 319353 samples
Epoch 1/100
1277409/1277409 - 32s - loss: 0.0385 - val_loss: 0.0387
Epoch 2/100
1277409/1277409 - 31s - loss: 0.0383 - val_loss: 0.0390
Epoch 3/100
1277409/1277409 - 31s - loss: 0.0383 - val_loss: 0.0383
Epoch 4/100
1277409/1277409 - 31s - loss: 0.0383 - val_loss: 0.0382
Epoch 5/100
1277409/1277409 - 31s - loss: 0.0382 - val_loss: 0.0381
Epoch 6/100
1277409/1277409 - 31s - loss: 0.0382 - val_loss: 0.0381
Epoch 7/100

Epoch 00007: ReduceLROnPlateau reducing learning rate to 0.00020000000949949026.
1277409/1277409 - 30s - loss: 0.0382 - val_loss: 0.0381
Epoch 8/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 9/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 10/100

Epoch 00010: ReduceLROnPlateau reducing learning rate to 4.0000001899898055e-05.
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0382
Epoch 11/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 12/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 13/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 14/100

Epoch 00014: ReduceLROnPlateau reducing learning rate to 8.000000525498762e-06.
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 15/100
1277409/1277409 - 31s - loss: 0.0381 - val_loss: 0.0381
Epoch 16/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 17/100

Epoch 00017: ReduceLROnPlateau reducing learning rate to 1.6000001778593287e-06.
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 18/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 19/100
1277409/1277409 - 31s - loss: 0.0381 - val_loss: 0.0381
Epoch 20/100

Epoch 00020: ReduceLROnPlateau reducing learning rate to 3.200000264769187e-07.
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 21/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 22/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 23/100

Epoch 00023: ReduceLROnPlateau reducing learning rate to 6.400000529538374e-08.
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 24/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 25/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 26/100

Epoch 00026: ReduceLROnPlateau reducing learning rate to 1.2800001059076749e-08.
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 27/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 28/100
1277409/1277409 - 30s - loss: 0.0381 - val_loss: 0.0381
Epoch 00028: early stopping
saving model  QRmodel_train_sz30pc_qnt30_20200911
min 1100.0001220703125, max 6713.01171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/fig/QCD_training_set:_BG_like_vs_SIG_like_mjj_distribution_and_their_ratio_qnt_30.jpg has been created
min 1100.0001220703125, max 7338.603515625
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/fig/QCD_test_set:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_30.jpg has been created
+---------------+-------------+
|     Sample    | Eff VAE [%] |
+---------------+-------------+
| qcdSigAllReco |    29.99    |
| GtoWW25naReco |    43.47    |
| GtoWW35naReco |    44.72    |
+---------------+-------------+
min 1100.037841796875, max 6329.51171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/fig/GtoWW25naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_30.jpg has been created
min 1100.159423828125, max 6971.1318359375
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/fig/GtoWW35naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_30.jpg has been created
/eos/home-k/kiwoznia/dev/analysis_physics_objects/anpofah/util/plotting_util.py:41: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig = plt.figure()
writing results for QCD signalregion all samples reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/30/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/30/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
writing results for $G(2.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/30/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/30/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
writing results for $G(3.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/30/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/30/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
writing analysis results to  /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50
Model: "model_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         [(None, 1)]               0         
_________________________________________________________________
dense_10 (Dense)             (None, 70)                140       
_________________________________________________________________
dense_11 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_12 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_13 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_14 (Dense)             (None, 1)                 71        
=================================================================
Total params: 15,121
Trainable params: 15,121
Non-trainable params: 0
_________________________________________________________________
Train on 1277409 samples, validate on 319353 samples
Epoch 1/100
1277409/1277409 - 32s - loss: 0.0396 - val_loss: 0.0395
Epoch 2/100
1277409/1277409 - 31s - loss: 0.0394 - val_loss: 0.0396
Epoch 3/100
1277409/1277409 - 32s - loss: 0.0394 - val_loss: 0.0395
Epoch 4/100
1277409/1277409 - 32s - loss: 0.0394 - val_loss: 0.0393
Epoch 5/100
1277409/1277409 - 31s - loss: 0.0394 - val_loss: 0.0394
Epoch 6/100
1277409/1277409 - 31s - loss: 0.0394 - val_loss: 0.0396
Epoch 7/100

Epoch 00007: ReduceLROnPlateau reducing learning rate to 0.00020000000949949026.
1277409/1277409 - 32s - loss: 0.0394 - val_loss: 0.0394
Epoch 8/100
1277409/1277409 - 32s - loss: 0.0393 - val_loss: 0.0393
Epoch 9/100
1277409/1277409 - 32s - loss: 0.0393 - val_loss: 0.0393
Epoch 10/100

Epoch 00010: ReduceLROnPlateau reducing learning rate to 4.0000001899898055e-05.
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 11/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 12/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 13/100

Epoch 00013: ReduceLROnPlateau reducing learning rate to 8.000000525498762e-06.
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 14/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 15/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 16/100

Epoch 00016: ReduceLROnPlateau reducing learning rate to 1.6000001778593287e-06.
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 17/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 18/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 19/100

Epoch 00019: ReduceLROnPlateau reducing learning rate to 3.200000264769187e-07.
1277409/1277409 - 30s - loss: 0.0393 - val_loss: 0.0393
Epoch 20/100
1277409/1277409 - 30s - loss: 0.0393 - val_loss: 0.0393
Epoch 21/100
1277409/1277409 - 30s - loss: 0.0393 - val_loss: 0.0393
Epoch 22/100

Epoch 00022: ReduceLROnPlateau reducing learning rate to 6.400000529538374e-08.
1277409/1277409 - 30s - loss: 0.0393 - val_loss: 0.0393
Epoch 23/100
1277409/1277409 - 31s - loss: 0.0393 - val_loss: 0.0393
Epoch 24/100
1277409/1277409 - 30s - loss: 0.0393 - val_loss: 0.0393
Epoch 00024: early stopping
/eos/home-k/kiwoznia/dev/data_driven_anomaly_hunting/dadrah/analysis/analysis_discriminator.py:14: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig = plt.figure(figsize=(8, 8))
saving model  QRmodel_train_sz30pc_qnt50_20200911
min 1100.0001220703125, max 6713.01171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/fig/QCD_training_set:_BG_like_vs_SIG_like_mjj_distribution_and_their_ratio_qnt_50.jpg has been created
min 1100.0001220703125, max 7338.603515625
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/fig/QCD_test_set:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_50.jpg has been created
+---------------+-------------+
|     Sample    | Eff VAE [%] |
+---------------+-------------+
| qcdSigAllReco |    50.04    |
| GtoWW25naReco |    61.83    |
| GtoWW35naReco |    63.35    |
+---------------+-------------+
min 1100.037841796875, max 6329.51171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/fig/GtoWW25naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_50.jpg has been created
min 1100.159423828125, max 6971.1318359375
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/fig/GtoWW35naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_50.jpg has been created
writing results for QCD signalregion all samples reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/50/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/50/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
writing results for $G(2.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/50/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/50/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
writing results for $G(3.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/50/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/50/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
writing analysis results to  /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70
Model: "model_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         [(None, 1)]               0         
_________________________________________________________________
dense_15 (Dense)             (None, 70)                140       
_________________________________________________________________
dense_16 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_17 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_18 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_19 (Dense)             (None, 1)                 71        
=================================================================
Total params: 15,121
Trainable params: 15,121
Non-trainable params: 0
_________________________________________________________________
Train on 1277409 samples, validate on 319353 samples
Epoch 1/100
1277409/1277409 - 32s - loss: 0.0312 - val_loss: 0.0312
Epoch 2/100
1277409/1277409 - 31s - loss: 0.0311 - val_loss: 0.0310
Epoch 3/100
1277409/1277409 - 31s - loss: 0.0311 - val_loss: 0.0310
Epoch 4/100
1277409/1277409 - 31s - loss: 0.0311 - val_loss: 0.0310
Epoch 5/100

Epoch 00005: ReduceLROnPlateau reducing learning rate to 0.00020000000949949026.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 6/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 7/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 8/100

Epoch 00008: ReduceLROnPlateau reducing learning rate to 4.0000001899898055e-05.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 9/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 10/100
1277409/1277409 - 30s - loss: 0.0310 - val_loss: 0.0310
Epoch 11/100

Epoch 00011: ReduceLROnPlateau reducing learning rate to 8.000000525498762e-06.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 12/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 13/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 14/100

Epoch 00014: ReduceLROnPlateau reducing learning rate to 1.6000001778593287e-06.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 15/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 16/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 17/100

Epoch 00017: ReduceLROnPlateau reducing learning rate to 3.200000264769187e-07.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 18/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 19/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 20/100

Epoch 00020: ReduceLROnPlateau reducing learning rate to 6.400000529538374e-08.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 21/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 22/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 23/100

Epoch 00023: ReduceLROnPlateau reducing learning rate to 1.2800001059076749e-08.
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 24/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 25/100
1277409/1277409 - 31s - loss: 0.0310 - val_loss: 0.0310
Epoch 00025: early stopping
saving model  QRmodel_train_sz30pc_qnt70_20200911
min 1100.0001220703125, max 6713.01171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/fig/QCD_training_set:_BG_like_vs_SIG_like_mjj_distribution_and_their_ratio_qnt_70.jpg has been created
min 1100.0001220703125, max 7338.603515625
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/fig/QCD_test_set:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_70.jpg has been created
+---------------+-------------+
|     Sample    | Eff VAE [%] |
+---------------+-------------+
| qcdSigAllReco |    70.03    |
| GtoWW25naReco |    78.99    |
| GtoWW35naReco |    78.98    |
+---------------+-------------+
min 1100.037841796875, max 6329.51171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/fig/GtoWW25naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_70.jpg has been created
min 1100.159423828125, max 6971.1318359375
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/fig/GtoWW35naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_70.jpg has been created
writing results for QCD signalregion all samples reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/70/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/70/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
writing results for $G(2.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/70/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/70/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
writing results for $G(3.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/70/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/70/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
writing analysis results to  /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/qnt90
Model: "model_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         [(None, 1)]               0         
_________________________________________________________________
dense_20 (Dense)             (None, 70)                140       
_________________________________________________________________
dense_21 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_22 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_23 (Dense)             (None, 70)                4970      
_________________________________________________________________
dense_24 (Dense)             (None, 1)                 71        
=================================================================
Total params: 15,121
Trainable params: 15,121
Non-trainable params: 0
_________________________________________________________________
Train on 1277409 samples, validate on 319353 samples
Epoch 1/100
1277409/1277409 - 33s - loss: 0.0138 - val_loss: 0.0137
Epoch 2/100
1277409/1277409 - 33s - loss: 0.0137 - val_loss: 0.0138
Epoch 3/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0138
Epoch 4/100

Epoch 00004: ReduceLROnPlateau reducing learning rate to 0.00020000000949949026.
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0138
Epoch 5/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 6/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 7/100

Epoch 00007: ReduceLROnPlateau reducing learning rate to 4.0000001899898055e-05.
1277409/1277409 - 31s - loss: 0.0137 - val_loss: 0.0137
Epoch 8/100
1277409/1277409 - 31s - loss: 0.0137 - val_loss: 0.0137
Epoch 9/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 10/100

Epoch 00010: ReduceLROnPlateau reducing learning rate to 8.000000525498762e-06.
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 11/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 12/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 13/100

Epoch 00013: ReduceLROnPlateau reducing learning rate to 1.6000001778593287e-06.
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 14/100
1277409/1277409 - 31s - loss: 0.0137 - val_loss: 0.0137
Epoch 15/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 16/100

Epoch 00016: ReduceLROnPlateau reducing learning rate to 3.200000264769187e-07.
1277409/1277409 - 31s - loss: 0.0137 - val_loss: 0.0137
Epoch 17/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 18/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 19/100

Epoch 00019: ReduceLROnPlateau reducing learning rate to 6.400000529538374e-08.
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 20/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 21/100
1277409/1277409 - 31s - loss: 0.0137 - val_loss: 0.0137
Epoch 22/100

Epoch 00022: ReduceLROnPlateau reducing learning rate to 1.2800001059076749e-08.
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 23/100
1277409/1277409 - 32s - loss: 0.0137 - val_loss: 0.0137
Epoch 24/100
1277409/1277409 - 31s - loss: 0.0137 - val_loss: 0.0137
Epoch 00024: early stopping
saving model  QRmodel_train_sz30pc_qnt90_20200911
min 1100.0001220703125, max 6713.01171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/qnt90/fig/QCD_training_set:_BG_like_vs_SIG_like_mjj_distribution_and_their_ratio_qnt_90.jpg has been created
min 1100.0001220703125, max 7338.603515625
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/qnt90/fig/QCD_test_set:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_90.jpg has been created
+---------------+-------------+
|     Sample    | Eff VAE [%] |
+---------------+-------------+
| qcdSigAllReco |    90.04    |
| GtoWW25naReco |    94.52    |
| GtoWW35naReco |    93.90    |
+---------------+-------------+
min 1100.037841796875, max 6329.51171875
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/qnt90/fig/GtoWW25naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_90.jpg has been created
min 1100.159423828125, max 6971.1318359375
TH1D::Sumw2:0: RuntimeWarning: Sum of squares of weights structure already created
Info in <TCanvas::Print>: jpg file /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/qnt10/qnt30/qnt50/qnt70/qnt90/fig/GtoWW35naReco:_BG_like_vs_SIG_like_mjj_distribution_and_ratio_qnt_90.jpg has been created
writing results for QCD signalregion all samples reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/90/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/90/qcd_sqrtshatTeV_13TeV_PU40_ALL_parts/qcd_sqrtshatTeV_13TeV_PU40_ALL_reco.h5
writing results for $G(2.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/90/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/90/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_2.5TeV_reco.h5
writing results for $G(3.5 TeV)\to WW$ narrow reco to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/90/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
written data sample to /eos/home-k/kiwoznia/data/VAE_results/bump_hunt_results/run_101/selections/90/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_parts/RSGraviton_WW_NARROW_13TeV_PU40_3.5TeV_reco.h5
